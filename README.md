C.A.R.E: Clinical Assistant for Research and Evidence

1. Project Overview

C.A.R.E. is a prototype clinical decision support system designed to assist medical professionals. It leverages a Retrieval-Augmented Generation (RAG) pipeline to analyze a patient's medical file, dynamically fetch relevant, up-to-date medical research, and generate a preliminary treatment plan.

The system features two main outputs:

A Preliminary Treatment Plan: Generated by a RAG pipeline that combines patient data with freshly sourced medical abstracts from the Semantic Scholar API.

Patient-Friendly Educational Material: A downloadable PDF, generated by a second LLM call, that explains the treatment plan in simple, compassionate, and easy-to-understand terms.

2. System Architecture

C.A.R.E. operates on a microservice-based architecture, decoupling the user-facing web interface from the intensive data processing pipeline.

1. Pathway RAG Pipeline Server (pipeline.py)

Technology: pathway

Role: Runs as a persistent background service (on http://localhost:8001).

Function:

Monitors the Data/processed/patient_text and Data/processed/research directories for new .txt files.

Automatically parses, splits, and indexes new documents using a hybrid search index (BM25 + Vector Embeddings).

Exposes an API endpoint (/v2/answer) that accepts a query, retrieves the most relevant context from its index, and generates a structured answer using an LLM (e.g., Llama 3 70B).

2. FastAPI Web Server (api_server.py)

Technology: fastapi, jinja2

Role: The user-facing application and orchestration layer (on http://localhost:8000).

Function:

Serves the main HTML interface (index.html).

Manages the end-to-end user workflow:

On patient selection, it calls the research_fetcher.

The research_fetcher dynamically queries the Semantic Scholar API for papers relevant to the patient's (disorder) conditions.

New papers are saved to the Data/processed/research directory, which the RAG pipeline automatically detects and indexes.

The server waits ~20 seconds to allow for indexing, then sends a sanitized, keyword-only prompt to the RAG server.

It receives the structured treatment plan, saves it to a temporary JSON file, and displays it to the user.

On a "Download PDF" request, it reads the temporary JSON file and calls the patient_educational_material module to generate and stream the PDF.

3. Input & Output Examples

Input 1 (Data): A patient summary file in Data/processed/patient_text/ (e.g., patient_123.txt) containing sections for conditions, medications, etc.

Input 2 (User): The user selects a patient from the dropdown menu in the web UI and clicks "Generate Treatment Plan".

Output 1 (UI): A structured "Preliminary Treatment Plan" is displayed on the webpage, broken down by medical condition. Each card shows the condition, the suggested treatment, and the supporting evidence from the patient file or fetched research.

Output 2 (Download): A downloadable PDF document titled "Your Preliminary Treatment Plan Explained" that provides a simple, compassionate explanation of the conditions and treatments, generated by an LLM.

4. Steps to Run the Project

1. Prerequisites

Python 3.10+

A Hugging Face API Token with access to the specified LLM (e.g., meta-llama/Meta-Llama-3-70B-Instruct).

2. Setup

Clone the repository:

git clone <your-repo-url>
cd C.A.R.E.



Create and activate a virtual environment:

python -m venv venv
source venv/bin/activate  # (On Windows: venv\Scripts\activate)



Install dependencies:
(You should create a requirements.txt file for this. Based on our work, the key dependencies are:)

pip install "fastapi[all]" uvicorn requests pathway-xpacks litellm python-dotenv reportlab



Set up environment variables:
Create a .env file in the project's root directory (C.A.R.E./.env):

HF_API_TOKEN="your_hugging_face_api_token_here"



3. Running the Application

This system requires two separate terminals to run.

Terminal 1: Start the RAG Pipeline Server

# From the C.A.R.E. root directory
python src/agent/pipeline.py



Wait until you see messages indicating the server is running on port 8001 and monitoring files.

Terminal 2: Start the FastAPI Web Server

# From the C.A.R.E. root directory
uvicorn api_server:app --reload



4. Access the Application

Open your web browser and navigate to:
https://www.google.com/search?q=http://127.0.0.1:8000
